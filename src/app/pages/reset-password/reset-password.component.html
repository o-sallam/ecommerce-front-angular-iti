<div class="auth-container">
  <div class="container-fluid">
    <div class="row justify-content-center">
      <div class="col-lg-6 col-xl-5">
        <div class="auth-card">
          <div class="auth-header">
            <h2 class="auth-title">Reset Password</h2>
            <p class="auth-subtitle" *ngIf="!passwordReset">
              Enter your new password below
            </p>
            <p class="auth-subtitle" *ngIf="passwordReset">
              Your password has been successfully reset
            </p>
          </div>

          <div class="auth-body">
            <!-- Success Message -->
            <div *ngIf="message" class="alert alert-success mb-3">
              <div class="success-icon mb-2">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <polyline points="22 4 12 14.01 9 11.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              {{ message }}
            </div>

            <!-- Error Message -->
            <div *ngIf="errorMsg" class="alert alert-danger mb-3">
              {{ errorMsg }}
            </div>

            <!-- Password Reset Success State -->
            <div *ngIf="passwordReset" class="password-reset-success">
              <div class="success-icon-large mb-3">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" stroke="#93353E" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <polyline points="22 4 12 14.01 9 11.01" stroke="#93353E" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              
              <h3 class="success-title">Password Reset Complete!</h3>
              <p class="success-description">
                Your password has been successfully updated. You can now log in with your new password.
              </p>

              <div class="success-actions">
                <button type="button" class="btn auth-btn-primary" (click)="goToLogin()">
                  Continue to Login
                </button>
              </div>
            </div>

            <!-- Reset Password Form -->
            <form *ngIf="!passwordReset && !errorMsg" class="auth-form" [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()">
              <div class="form-floating mb-4 position-relative">
                <input
                  [type]="showPassword ? 'text' : 'password'"
                  class="form-control"
                  id="password"
                  placeholder="New Password"
                  formControlName="password"
                />
                <label for="password" class="auth-label">
                  <i class="fas fa-lock me-2"></i>New Password
                </label>
                <button
                  type="button"
                  class="toggle-password-btn"
                  (click)="togglePasswordVisibility('password')"
                >
                  {{ showPassword ? "Hide" : "Show" }}
                </button>
                <div *ngIf="resetPasswordForm.get('password')?.invalid && resetPasswordForm.get('password')?.touched" class="invalid-feedback d-block">
                  <span *ngIf="resetPasswordForm.get('password')?.errors?.['required']">Password is required</span>
                  <span *ngIf="resetPasswordForm.get('password')?.errors?.['minlength']">Password must be at least 6 characters</span>
                </div>
              </div>

              <div class="form-floating mb-4 position-relative">
                <input
                  [type]="showConfirmPassword ? 'text' : 'password'"
                  class="form-control"
                  id="confirmPassword"
                  placeholder="Confirm New Password"
                  formControlName="confirmPassword"
                />
                <label for="confirmPassword" class="auth-label">
                  <i class="fas fa-lock me-2"></i>Confirm New Password
                </label>
                <button
                  type="button"
                  class="toggle-password-btn"
                  (click)="togglePasswordVisibility('confirmPassword')"
                >
                  {{ showConfirmPassword ? "Hide" : "Show" }}
                </button>
                <div *ngIf="resetPasswordForm.get('confirmPassword')?.invalid && resetPasswordForm.get('confirmPassword')?.touched" class="invalid-feedback d-block">
                  <span *ngIf="resetPasswordForm.get('confirmPassword')?.errors?.['required']">Please confirm your password</span>
                  <span *ngIf="resetPasswordForm.get('confirmPassword')?.errors?.['passwordMismatch']">Passwords do not match</span>
                </div>
              </div>

              <div class="password-requirements mb-4">
                <h6>Password Requirements:</h6>
                <ul>
                  <li [class.valid]="resetPasswordForm.get('password')?.value?.length >= 6">
                    <i class="fas fa-check" *ngIf="resetPasswordForm.get('password')?.value?.length >= 6"></i>
                    <i class="fas fa-times" *ngIf="resetPasswordForm.get('password')?.value?.length < 6"></i>
                    At least 6 characters
                  </li>
                </ul>
              </div>

              <div class="d-grid mb-4">
                <button
                  type="submit"
                  class="btn auth-btn-primary"
                  [disabled]="loading || resetPasswordForm.invalid"
                >
                  <span *ngIf="!loading">Reset Password</span>
                  <span *ngIf="loading">
                    <i class="fas fa-spinner fa-spin"></i> Resetting...
                  </span>
                </button>
              </div>

              <div class="auth-footer text-center">
                <p>
                  Remember your password?
                  <a routerLink="/login" class="auth-link">Back to Login</a>
                </p>
              </div>
            </form>

            <!-- Error State Actions -->
            <div *ngIf="errorMsg" class="error-actions text-center">
              <button type="button" class="btn auth-btn-primary" routerLink="/forgot-password">
                Request New Reset Link
              </button>
              <p class="mt-3">
                <a routerLink="/login" class="auth-link">Back to Login</a>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>